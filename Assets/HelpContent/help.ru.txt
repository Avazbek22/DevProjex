## 1) Что это и для чего
DevProjex быстро формирует контекст проекта: показывает структуру папок/файлов, позволяет выбрать элементы галочками и скопировать дерево и/или содержимое файлов в буфер обмена. Удобно для code review, поддержки, обучения и передачи структуры проекта AI-ассистенту.

Важно: приложение работает только в режиме чтения и не изменяет файлы.

## 2) Дерево проекта
* Иконки типов файлов/папок.
* Чекбоксы на узлах.
* Раскрытие/сворачивание.

Чекбоксы: отметка узла применяется к потомкам; состояние родителей пересчитывается автоматически.

Горячие клавиши:
* Ctrl+E — раскрыть всё
* Ctrl+W — свернуть всё (корень остаётся раскрытым)

## 3) Файл
* Открыть папку… — открыть корневую папку (Ctrl+O)
* Обновить — перечитать и перестроить дерево (F5)
* Экспорт в файл:
  * Экспорт дерева
  * Экспорт содержимого
  * Экспорт дерева и содержимого

Правила формата:
* Экспорт дерева — формат зависит от переключателя ASCII/JSON.
* Экспорт содержимого — всегда текстовый формат содержимого (переключатель ASCII/JSON не влияет).
* Экспорт дерева и содержимого — формат блока дерева зависит от переключателя ASCII/JSON, блок содержимого остаётся текстовым.

Файлы экспорта записываются в UTF-8 без BOM.

### Drag & Drop
Перетаскивание работает через стартовую область (Drop Zone), когда проект не загружен.

Правила:
* можно перетаскивать папку;
* можно перетаскивать файл — в этом случае открывается папка, в которой находится файл;
* если перетащено несколько объектов, используется первый подходящий локальный путь;
* если путь недоступен или не существует, применяется та же проверка доступа, что и при «Открыть папку…»;
* неподдерживаемые или нелокальные объекты игнорируются.

## 4) Git
Git‑меню доступно только для проектов, клонированных через DevProjex (Git Clone). Приложение не трогает ваши файлы — работает только с кэшем.

Кэш хранится в системной временной папке. На Windows это обычно:
`%TEMP%\DevProjex\RepoCache`

* Ветка — показывает список удалённых веток; при переключении дерево обновляется под выбранную ветку. Если ветка уже есть локально, переключение без сети (без обновления). Если ветки локально нет — она скачивается (fetch) и создаётся локально.
* Получить обновления — обновляет только текущую ветку: выполняется fetch и сброс к origin/<ветка>.

## 5) Копирование
### Переключатель формата дерева (ASCII/JSON)
Переключатель задаёт формат представления дерева для операций, где дерево участвует в результате.

* ASCII — текстовое дерево с ветками.
* JSON — структурированное дерево в JSON.

Переключатель влияет на:
* Скопировать дерево
* Скопировать дерево + содержимое
* Экспорт дерева
* Экспорт дерева и содержимого

Переключатель не влияет на:
* Скопировать содержимое
* Экспорт содержимого

### Скопировать дерево
Копирует дерево проекта.
Если есть отмеченные узлы — дерево строится по выделению; если выделение пустое или невалидное — копируется полное дерево.
Формат результата определяется переключателем ASCII/JSON.
Горячие клавиши: Ctrl+Shift+C и Ctrl+Alt+C.

### Скопировать содержимое
Копирует содержимое файлов:
* если есть отмеченные файлы — берутся только они; иначе — все файлы проекта;
* нетекстовые файлы игнорируются (включая бинарные);
* для пустых текстовых файлов выводится путь и строка `[No Content, 0 bytes]`;
* для файлов, состоящих только из пробелов/переводов строк, выводится путь и строка `[Whitespace, N bytes]`.
Горячая клавиша: Ctrl+Alt+V.

### Скопировать дерево + содержимое
Комбинирует дерево и содержимое:
* дерево строится по выделению; если выделение пустое/невалидное — берётся полное дерево;
* содержимое берётся по тем же правилам, что в «Скопировать содержимое»;
* формат блока дерева определяется переключателем ASCII/JSON.
Горячая клавиша: Ctrl+Shift+V.

### JSON-представление
Для режима JSON используется компактная структура.

Дерево:
* `rootPath` — абсолютный путь корня.
* `root` — корневой узел.
* узел: `name`, `path`, `dirs`, `files`, `accessDenied` (при необходимости).

Дерево + содержимое:
* `rootPath` — абсолютный путь корня.
* `tree` — JSON-дерево.
* `content` — текстовый блок содержимого файлов.

## 6) Вид
### Масштаб
* Ctrl++ / Ctrl+= — увеличить
* Ctrl+- — уменьшить
* Ctrl+0 — сброс
* Ctrl + колесо мыши над деревом — плавно

Диапазон: 6–28, сброс — 12.

### Компактный режим
Делает интерфейс плотнее: меньше отступы в дереве и настройках.

## 7) Поиск по дереву
Открывает панель поиска, подсвечивает совпадения и позволяет навигацию.
* Ctrl+F — показать/скрыть
* Enter — следующий результат
* Shift+Enter — предыдущий
* Esc — закрыть

Поиск автоматически раскрывает только нужные ветки; при очистке запроса дерево сворачивается (кроме корня).

## 8) Фильтр по имени
Показывает только узлы, соответствующие строке фильтра, и их родителей. Обновление — с задержкой (debounce).
* Ctrl+Shift+N — показать/скрыть фильтр
* Esc — закрыть фильтр

## 9) Параметры
Справа доступны списки:
* Шрифт дерева — применяется кнопкой Применить
* Игнорировать
* Типы файлов
* Папки верхнего уровня

У каждого списка есть переключатель Все (включить/выключить всё).

Ctrl+P — показать/скрыть панель.

## 10) Игнорирование
Список «Игнорировать» формируется автоматически по текущему пути и выбранным папкам верхнего уровня.

Порядок пунктов:
* Умный игнор (если доступен)
* Использовать .gitignore (если найден хотя бы один `.gitignore`)
* Скрытые папки
* Скрытые файлы
* Папки с точкой в начале
* Файлы с точкой в начале

Линия под «Использовать .gitignore» отделяет Git/Smart-правила от базовых правил видимости.

### 10.1 Область применения правил
Приложение строит проектные области (scope), в которых применяются правила игнорирования:
* корень (если в корне есть `.gitignore` или маркер проекта)
* папки первого уровня
* вложенные проектные подпапки

Глубина поиска вложенных проектных областей фиксированная: 2 уровня.

### 10.2 Что делает «Использовать .gitignore»
* Включено: применяются правила `.gitignore` в найденных областях.
* Выключено: правила `.gitignore` полностью отключаются.

Для папки с несколькими проектами `.gitignore` одного проекта не применяется к соседним проектам вне его области.

### 10.3 Что делает «Умный игнор»
* Показывается только когда есть смысл его применять.
* Включено: дополнительно скрываются типичные артефакты сборки и инструментов.
* Выключено: smart-правила не применяются.

### 10.4 Базовые правила
Пункты:
* Скрытые папки
* Скрытые файлы
* Папки с точкой в начале
* Файлы с точкой в начале

Эти правила независимы от `.gitignore` и Smart Ignore и работают только по своим переключателям.

### 10.5 Под капотом: типовые кейсы
1. Один проект, есть `.gitignore`.
В списке обычно виден только «Использовать .gitignore».
При включении работают `.gitignore` и Smart Ignore.
При выключении отключаются и `.gitignore`, и Smart Ignore.

2. Один проект, `.gitignore` нет.
Пункт «Использовать .gitignore» не показывается.
«Умный игнор» показывается только если он уместен.

3. Рабочая папка с несколькими проектами, часть с `.gitignore`, часть без.
Показываются «Использовать .gitignore» и «Умный игнор».
`.gitignore` работает в своих областях.
Smart Ignore (если включен) дополняет фильтрацию по найденным областям.

4. Рабочая папка с несколькими проектами, `.gitignore` есть у всех.
Показывается «Использовать .gitignore».
«Умный игнор» как отдельный пункт не показывается.

5. Папка без релевантных правил.
Если `.gitignore` не найден и Smart Ignore неуместен, эти пункты не отображаются.
Остаются только базовые правила видимости.
## 11) Как строится дерево и подсчёт данных
На результат влияют:
* выбранные папки верхнего уровня
* выбранные типы файлов
* правила игнорирования
* активный фильтр
* отмеченные чекбоксами узлы (для операций по выделению)

Если нет разрешения на доступ к папке, узел помечается как Доступ запрещён.

### 11.1 Что показывают счётчики в статус-баре
В статус-баре есть два блока:
* Дерево — метрики текстового представления дерева;
* Содержимое — метрики блока содержимого файлов.

Формат:
* Строки
* Символы
* ~Токены (приблизительная оценка)

Для крупных значений используется сокращение (K/M).

### 11.2 Как считаются метрики
Метрики дерева:
* считаются по фактическому тексту дерева, который формируется тем же экспортным пайплайном;
* учитывают текущий формат ASCII/JSON.

Метрики содержимого:
* считаются по тем же правилам, что и экспорт/копирование содержимого;
* бинарные файлы не включаются;
* пустые и whitespace-only файлы учитываются через служебные маркеры (`[No Content, 0 bytes]`, `[Whitespace, N bytes]`).

### 11.3 Когда счётчики обновляются
Пересчёт выполняется:
* после открытия/обновления проекта;
* после применения настроек (игнор, типы файлов, папки верхнего уровня);
* при изменении чекбоксов в дереве (с debounce);
* при переключении ASCII/JSON (для операций, где участвует дерево).

## 12) Иконки
Иконка выбирается по:
1) типу узла (папка/файл)
2) точному имени (если есть правило)
3) расширению
4) иначе — неизвестный

## 13) Тема и эффекты
Popover темы позволяет переключать:
* светлая/тёмная тема
* Прозрачный / Mica / Acrylic
* параметры интенсивности, размытия, контраста и границ

Пункты с пометкой [Beta] могут менять поведение между версиями.

## 14) Справка → О программе
Открывает popover с информацией о приложении и ссылкой на репозиторий.
Сброс настроек (Справка → Сбросить настройки) возвращает параметры темы и эффектов к исходным значениям.
* Esc — закрыть popover

## 15) Языки
Выбор языка выполняется через меню Язык.

## 16) Прогресс-бар и отмена
В центральной части статус-бара показывается текущая операция и прогресс.

Режимы прогресса:
* Indeterminate — без процента (операция неопределённой длительности).
* Determinate — с процентом (0–100).

Поведение:
* во время фонового подсчёта данных показывается процентный прогресс;
* для части Git-операций процент отображается, если источник прогресса передаёт значение в процентах;
* для быстрых операций прогресс может появляться кратковременно.

Кнопка X (отмена) в статус-баре:
* выполняет best-effort отмену операций, у которых есть поддержка отмены;
* останавливает фоновый подсчёт данных;
* для операций без поддержки отмены завершает индикацию в статус-баре, при этом сама операция может завершиться в фоне.

## 17) Примечания
* По умолчанию применяется тёмная тема и режим с эффектом прозрачности (если поддерживается системой).
* При нехватке прав приложение может предложить перезапуск с повышенными правами; при отказе покажет уведомление.

