## 1) Что это и для чего
DevProjex быстро формирует контекст проекта: показывает структуру папок/файлов, позволяет выбрать элементы галочками и скопировать дерево и/или содержимое файлов в буфер обмена. Удобно для code review, поддержки, обучения и передачи структуры проекта AI-ассистенту.

Важно: приложение работает только в режиме чтения и не изменяет файлы.

## 2) Дерево проекта
* Иконки типов файлов/папок.
* Чекбоксы на узлах.
* Раскрытие/сворачивание.

Чекбоксы: отметка узла применяется к потомкам; состояние родителей пересчитывается автоматически.

Горячие клавиши:
* Ctrl+E — раскрыть всё
* Ctrl+W — свернуть всё (корень остаётся раскрытым)

## 3) Файл
* Открыть папку… — открыть корневую папку (Ctrl+O)
* Обновить — перечитать и перестроить дерево (F5)
* Экспорт в файл:
  * Экспорт дерева
  * Экспорт содержимого
  * Экспорт дерева и содержимого

Правила формата:
* Экспорт дерева:
  * ASCII → только `.txt`.
  * JSON → по умолчанию `.json`, при сохранении доступны `.json` и `.txt`.
* Экспорт содержимого — всегда текстовый формат содержимого, файл `.txt` (переключатель ASCII/JSON не влияет).
* Экспорт дерева и содержимого — всегда файл `.txt`; переключатель ASCII/JSON влияет только на формат блока дерева внутри результата.

Файлы экспорта записываются в UTF-8 без BOM.

### Drag & Drop
Перетаскивание работает через стартовую область (Drop Zone), когда проект не загружен.

Правила:
* можно перетаскивать папку;
* можно перетаскивать файл — в этом случае открывается папка, в которой находится файл;
* если перетащено несколько объектов, используется первый подходящий локальный путь;
* если путь недоступен или не существует, применяется та же проверка доступа, что и при «Открыть папку…»;
* неподдерживаемые или нелокальные объекты игнорируются.

## 4) Git
Git‑меню доступно только для проектов, клонированных через DevProjex (Git Clone). Приложение не трогает ваши файлы — работает только с кэшем.

Кэш хранится в системной временной папке. На Windows это обычно:
`%TEMP%\DevProjex\RepoCache`

* Ветка — показывает список доступных веток с пометкой активной. При переключении дерево обновляется под выбранную ветку. Если ветка уже есть локально, переключение без сети (без обновления). Если локальной ветки нет — выполняется fetch и создаётся локальная ветка.
* Получить обновления — обновляет только текущую ветку: выполняется fetch и сброс к origin/<ветка>.

## 5) Копирование
### Переключатель формата дерева (ASCII/JSON)
Переключатель задаёт формат представления дерева для операций, где дерево участвует в результате.

* ASCII — текстовое дерево с ветками.
* JSON — структурированное дерево в JSON.

Переключатель влияет на:
* Скопировать дерево
* Скопировать дерево + содержимое
* Экспорт дерева
* Экспорт дерева и содержимого

Переключатель не влияет на:
* Скопировать содержимое
* Экспорт содержимого

### Скопировать дерево
Копирует дерево проекта.
Если есть отмеченные узлы — дерево строится по выделению; если выделение пустое или невалидное — копируется полное дерево.
Формат результата определяется переключателем ASCII/JSON.
Горячие клавиши: Ctrl+Shift+C и Ctrl+Alt+C.

### Скопировать содержимое
Копирует содержимое файлов:
* если есть отмеченные файлы — берутся только они; иначе — все файлы проекта;
* нетекстовые файлы игнорируются (включая бинарные);
* для пустых текстовых файлов выводится путь и строка `[No Content, 0 bytes]`;
* для файлов, состоящих только из пробелов/переводов строк, выводится путь и строка `[Whitespace, N bytes]`.
Горячая клавиша: Ctrl+Alt+V.

### Скопировать дерево + содержимое
Комбинирует дерево и содержимое:
* дерево строится по выделению; если выделение пустое/невалидное — берётся полное дерево;
* содержимое берётся по тем же правилам, что в «Скопировать содержимое»;
* формат блока дерева определяется переключателем ASCII/JSON.
Горячая клавиша: Ctrl+Shift+V.

### JSON-представление
Для режима JSON используется компактная структура дерева.

Дерево (Скопировать дерево / Экспорт дерева):
* `rootPath` — путь корня в текущем формате вывода:
  * для локальной папки — абсолютный локальный путь;
  * для Git-проекта — URL репозитория.
* `root` — корневой узел.
* узел: `name`, `path`, `dirs`, `files`, `accessDenied` (при необходимости).

Дерево + содержимое:
* JSON применяется к блоку дерева;
* блок содержимого остаётся текстовым;
* при экспорте сохраняется в `.txt`.

## 6) Режим превью
Открывается кнопкой с иконкой глаза в верхней панели или клавишами Ctrl+B.

Показывает итоговый результат в режиме только чтения, без копирования в буфер и без экспорта в файл.

Доступные режимы:
* Дерево
* Содержимое
* Дерево и содержимое

Применяются те же правила, что и при копировании и экспорте:
* учитываются отмеченные узлы;
* если выбор пустой, используется полный набор данных;
* действуют текущие игнор-правила и параметры отбора.

При открытом превью поиск и фильтр недоступны.
В параметрах доступно только изменение шрифта.
Закрытие: кнопка X или повторное нажатие на иконку глаза.

## 7) Вид
### Масштаб
* Ctrl++ / Ctrl+= — увеличить
* Ctrl+- — уменьшить
* Ctrl+0 — сброс
* Ctrl + колесо мыши над деревом и в режиме превью — плавно

Диапазон: 6–28, сброс — 15.

### Компактный режим
Делает интерфейс плотнее: меньше отступы в дереве и настройках.

### Анимация дерева
Включает плавную анимацию смещения строк при наведении на элементы дерева.

## 8) Поиск по дереву
Открывает панель поиска, подсвечивает совпадения и позволяет навигацию.
* Ctrl+F — показать/скрыть
* Enter — следующий результат
* Shift+Enter — предыдущий
* Esc — закрыть

Поиск автоматически раскрывает только нужные ветки; при очистке запроса дерево сворачивается (кроме корня).

Ограничения:
* при открытии поиска фильтр закрывается автоматически;
* в режиме превью поиск недоступен.

## 9) Фильтр по имени
Показывает только узлы, соответствующие строке фильтра, и их родителей. Обновление — с задержкой (debounce).
* Ctrl+Shift+N — показать/скрыть фильтр
* Esc — закрыть фильтр

Ограничения:
* при открытии фильтра поиск закрывается автоматически;
* в режиме превью фильтр недоступен.

## 10) Параметры
Справа доступны списки:
* Шрифт дерева — применяется кнопкой Применить
* Игнорировать
* Типы файлов
* Папки верхнего уровня

У каждого списка есть переключатель Все (включить/выключить всё).

Примечание по «Типам файлов»:
* в этом списке отображаются только файлы с расширением;
* файлы без расширения в этот список не добавляются и управляются отдельным пунктом в «Игнорировать».

Ctrl+P — показать/скрыть панель.

## 11) Игнорирование
Список «Игнорировать» формируется автоматически по текущему пути и выбранным папкам верхнего уровня.

Порядок пунктов:
* Умный игнор (если доступен)
* Использовать .gitignore (если найден хотя бы один `.gitignore`)
* Скрытые папки
* Скрытые файлы
* Папки с точкой в начале
* Файлы с точкой в начале
* Файлы без расширений (показывается только если такие файлы обнаружены)

Линия под «Использовать .gitignore» отделяет Git/Smart-правила от базовых правил видимости.

### 11.1 Область применения правил
Приложение строит проектные области (scope), в которых применяются правила игнорирования:
* корень (если в корне есть `.gitignore` или маркер проекта)
* папки первого уровня
* вложенные проектные подпапки

Глубина поиска вложенных проектных областей фиксированная: 2 уровня.

### 11.2 Что делает «Использовать .gitignore»
* Включено: применяются правила `.gitignore` в найденных областях.
* Выключено: правила `.gitignore` полностью отключаются.

Для папки с несколькими проектами `.gitignore` одного проекта не применяется к соседним проектам вне его области.

### 11.3 Что делает «Умный игнор»
* Показывается только когда есть смысл его применять.
* Включено: дополнительно скрываются типичные артефакты сборки и инструментов.
* Выключено: smart-правила не применяются.

### 11.4 Базовые правила
Пункты:
* Скрытые папки
* Скрытые файлы
* Папки с точкой в начале
* Файлы с точкой в начале

Эти правила независимы от `.gitignore` и Smart Ignore и работают только по своим переключателям.

### 11.5 Под капотом: типовые кейсы
1. Один проект, есть `.gitignore`.
В списке обычно виден только «Использовать .gitignore».
При включении работают `.gitignore` и Smart Ignore.
При выключении отключаются и `.gitignore`, и Smart Ignore.

2. Один проект, `.gitignore` нет.
Пункт «Использовать .gitignore» не показывается.
«Умный игнор» показывается только если он уместен.

3. Рабочая папка с несколькими проектами, часть с `.gitignore`, часть без.
Показываются «Использовать .gitignore» и «Умный игнор».
`.gitignore` работает в своих областях.
Smart Ignore (если включен) дополняет фильтрацию по найденным областям.

4. Рабочая папка с несколькими проектами, `.gitignore` есть у всех.
Показывается «Использовать .gitignore».
«Умный игнор» как отдельный пункт не показывается.

5. Папка без релевантных правил.
Если `.gitignore` не найден и Smart Ignore неуместен, эти пункты не отображаются.
Остаются только базовые правила видимости.

### 11.6 Файлы без расширений
Пункт «Файлы без расширений» управляет отображением файлов без расширения (например: `Dockerfile`, `Makefile`, `README`).

Правила:
* пункт показывается только когда такие файлы реально есть в текущем наборе данных;
* при включении пункта файлы без расширения исключаются из дерева и из операций копирования/экспорта;
* при выключении пункта файлы без расширения включаются в результат;
* список «Типы файлов» на этот механизм не влияет.
## 12) Как строится дерево и подсчёт данных
На результат влияют:
* выбранные папки верхнего уровня
* выбранные типы файлов
* правила игнорирования
* активный фильтр
* отмеченные чекбоксами узлы (для операций по выделению)

Если нет разрешения на доступ к папке, узел помечается как Доступ запрещён.

### 12.1 Что показывают счётчики в статус-баре
В статус-баре есть два блока:
* Дерево — метрики текстового представления дерева;
* Содержимое — метрики блока содержимого файлов.

Формат:
* Строки
* Символы
* ~Токены (приблизительная оценка)

Для крупных значений используется сокращение (K/M).

Важно:
* «Строки» в блоке «Дерево» — это количество строк итогового представления дерева, а не количество файлов на диске;
* в это число входят и папки, и файлы, и служебные элементы дерева (например, узлы с пометкой доступа).

### 12.2 Как считаются метрики
Метрики дерева:
* считаются по фактическому тексту дерева, который формируется тем же экспортным пайплайном;
* учитывают текущий формат ASCII/JSON.

Метрики содержимого:
* считаются по тем же правилам, что и экспорт/копирование содержимого;
* бинарные файлы не включаются;
* пустые и whitespace-only файлы учитываются через служебные маркеры (`[No Content, 0 bytes]`, `[Whitespace, N bytes]`).

### 12.3 Когда счётчики обновляются
Пересчёт выполняется:
* после открытия/обновления проекта;
* после применения настроек (игнор, типы файлов, папки верхнего уровня);
* при изменении чекбоксов в дереве (с debounce);
* при переключении ASCII/JSON (для операций, где участвует дерево).
* при отмене фонового подсчёта значения счётчиков устанавливаются в 0 до следующего завершённого пересчёта.

## 13) Иконки
Иконка выбирается по:
1) типу узла (папка/файл)
2) точному имени (если есть правило)
3) расширению
4) иначе — неизвестный

## 14) Тема и эффекты
Popover темы позволяет переключать:
* светлая/тёмная тема
* Прозрачный / Mica / Acrylic
* параметры интенсивности, размытия, контраста и границ

Пункты с пометкой [Beta] могут менять поведение между версиями.

## 15) Справка → О программе
Открывает popover с информацией о приложении и ссылкой на репозиторий.
Сброс настроек (Справка → Сбросить настройки) сбрасывает только визуальные параметры интерфейса (тема, эффекты, компактный режим, анимация дерева) и не изменяет данные проекта.
* Esc — закрыть popover

## 16) Языки
Выбор языка выполняется через меню Язык.

## 17) Прогресс-бар и отмена
В центральной части статус-бара показывается текущая операция и прогресс.

Режимы прогресса:
* Indeterminate — без процента (операция неопределённой длительности).
* Determinate — с процентом (0–100).

Поведение:
* во время фонового подсчёта данных показывается процентный прогресс;
* для части Git-операций процент отображается, если источник прогресса передаёт значение в процентах;
* для быстрых операций прогресс может появляться кратковременно.

Кнопка X (отмена) в статус-баре:
* выполняет best-effort отмену операций, у которых есть поддержка отмены;
* останавливает фоновый подсчёт данных;
* для операций без поддержки отмены завершает индикацию в статус-баре, при этом сама операция может завершиться в фоне.

## 18) Примечания
* По умолчанию применяется тёмная тема и режим с эффектом прозрачности (если поддерживается системой).
* При нехватке прав приложение может предложить перезапуск с повышенными правами; при отказе покажет уведомление.


