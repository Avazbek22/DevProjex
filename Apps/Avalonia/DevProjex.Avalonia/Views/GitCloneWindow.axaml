<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:DevProjex.Avalonia.ViewModels"
        x:Class="DevProjex.Avalonia.Views.GitCloneWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="{Binding GitCloneTitle}"
        Width="420"
        MinWidth="360"
        SizeToContent="Height"
        CanResize="False"
        ShowInTaskbar="False"
        WindowStartupLocation="CenterOwner"
        Background="Transparent"
        SystemDecorations="None"
        TransparencyLevelHint="AcrylicBlur, Blur, None"
        Icon="avares://DevProjex.Avalonia/AppIcon/icon-256.png">
  <Window.Styles>
    <Style Selector="Border.clone-window-card">
      <Setter Property="Background" Value="{DynamicResource MenuPopupBrush}" />
      <Setter Property="BorderBrush" Value="{DynamicResource AppBorderBrush}" />
      <Setter Property="BorderThickness" Value="1" />
      <Setter Property="CornerRadius" Value="12" />
      <Setter Property="ClipToBounds" Value="True" />
      <Setter Property="Opacity" Value="0.98" />
      <Setter Property="BoxShadow" Value="0 6 20 0 #50000000" />
    </Style>

    <Style Selector="Border.clone-progress-surface">
      <Setter Property="Background" Value="{DynamicResource MenuChildPopupBrush}" />
      <Setter Property="BorderBrush" Value="{DynamicResource AppBorderBrush}" />
      <Setter Property="BorderThickness" Value="1" />
      <Setter Property="CornerRadius" Value="8" />
      <Setter Property="Opacity" Value="0.9" />
      <Setter Property="Padding" Value="10" />
    </Style>
  </Window.Styles>

  <Border Name="CloneWindowCard"
          Classes="clone-window-card"
          Padding="16">
    <Grid RowDefinitions="Auto,Auto,Auto,Auto">
      <!-- Description (visible when not in progress) -->
      <TextBlock Grid.Row="0"
                 Text="{Binding GitCloneDescription}"
                 Margin="0,0,0,8"
                 TextWrapping="Wrap"
                 FontSize="13"
                 Opacity="0.8"
                 IsVisible="{Binding !GitCloneInProgress}" />

      <!-- URL Input (visible when not in progress) -->
      <TextBox Grid.Row="1"
               Name="UrlTextBox"
               Text="{Binding GitCloneUrl, Mode=TwoWay}"
               Watermark="{Binding GitCloneUrlPlaceholder}"
               Margin="0,0,0,16"
               IsVisible="{Binding !GitCloneInProgress}"
               KeyDown="OnUrlKeyDown" />

      <!-- Progress section (visible when in progress) -->
      <Border Grid.Row="1"
              Classes="clone-progress-surface"
              Margin="0,0,0,16"
              IsVisible="{Binding GitCloneInProgress}">
        <StackPanel>
          <TextBlock Text="{Binding GitCloneStatus}"
                     FontSize="13"
                     Margin="0,0,0,8" />
          <ProgressBar IsIndeterminate="True"
                       Height="4" />
        </StackPanel>
      </Border>

      <!-- Buttons -->
      <StackPanel Grid.Row="2"
                  Orientation="Horizontal"
                  HorizontalAlignment="Right"
                  Spacing="8">
        <Button Content="{Binding DialogOK}"
                Classes="primary-action"
                MinWidth="80"
                HorizontalContentAlignment="Center"
                Click="OnStartClone"
                IsVisible="{Binding !GitCloneInProgress}"
                IsEnabled="{Binding GitCloneUrl.Length}" />
        <Button Content="{Binding DialogCancel}"
                Click="OnCancel" />
      </StackPanel>
    </Grid>
  </Border>
</Window>
